function(_add_dialect target td_file bind_name)
  set(LLVM_TARGET_DEFINITIONS ${td_file})
  mlir_tablegen("${bind_name}.py" -gen-python-op-bindings -bind-dialect=${bind_name})
  add_public_tablegen_target(${target})
  add_dependencies(NPCOMPNativePyExt ${target})
  
  install(FILES ${CMAKE_CURRENT_BINARY_DIR}/${bind_name}.py
  DESTINATION python/npcomp/dialects
  COMPONENT python)
endfunction()

_add_dialect(NPCOMPPyDialectBasicpy BasicpyBind.td "basicpy")
_add_dialect(NPCOMPPyDialectNumpy NumpyBind.td "numpy")
_add_dialect(NPCOMPPyDialectTCF TCFBind.td "tcf")
_add_dialect(NPCOMPPyDialectTorch TorchBind.td "torch")
